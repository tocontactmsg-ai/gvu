<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Admin â€” Edit ads.json</title>
<style>
  body{font-family:Tahoma,Arial;margin:12px;background:#f7f9fc;color:#111}
  .wrap{max-width:900px;margin:0 auto}
  label{display:block;margin-top:8px;font-weight:600}
  input,textarea,select{width:100%;padding:8px;border-radius:6px;border:1px solid #ddd;margin-top:6px}
  .row{display:flex;gap:8px}
  .row > *{flex:1}
  button{margin-top:10px;padding:8px 12px;border-radius:8px;border:none;background:#0078d7;color:#fff;cursor:pointer}
  .ad-item{background:#fff;padding:10px;border-radius:8px;margin-top:10px;border:1px solid #e8eef6}
  .small{font-size:13px;color:#555}
  img.preview{max-width:160px;margin-top:8px;border-radius:6px}
  .actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
  pre{background:#eef4fb;padding:10px;border-radius:6px;overflow:auto}
</style>
</head>
<body>
<div class="wrap">
  <h2>Ù„ÙˆØ­Ø© (Ù…Ø³Ø§Ø¹Ø¯Ø©) ØªØ¹Ø¯ÙŠÙ„ ads.json</h2>
  <p class="small">Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ù„Ø¥Ø¹Ø¯Ø§Ø¯/ØªØ¹Ø¯ÙŠÙ„ Ø¥Ø¹Ù„Ø§Ù†Ø§Øª Ø«Ù… Ø­Ù…Ù‘Ù„ Ù…Ù„Ù <code>ads.json</code> Ø§Ù„Ù†Ø§ØªØ¬ ÙˆØ§Ø¯ÙØ¹Ù‡ Ø¥Ù„Ù‰ GitHub.</p>

  <div id="form">
    <label>Ø±Ù…Ø² Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† (code)</label>
    <input id="f_code" placeholder="Ù…Ø«Ø§Ù„: AB12CD">

    <label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label>
    <input id="f_title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†">

    <label>Ø§Ù„ÙˆØµÙ</label>
    <textarea id="f_desc" rows="3" placeholder="ÙˆØµÙ Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†"></textarea>

    <div class="row">
      <div>
        <label>Ø§Ù„Ù…ÙˆÙ‚Ø¹</label>
        <input id="f_loc" placeholder="Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©">
      </div>
      <div>
        <label>Ø§Ù„ØªÙˆØ§ØµÙ„</label>
        <input id="f_contact" placeholder="+2499...">
      </div>
    </div>

    <label>Ø§Ù„ØµÙˆØ±Ø© (Ø§Ø®ØªØ± Ù…Ù„Ù Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©)</label>
    <input id="f_file" type="file" accept="image/*">
    <div id="imgPreview"></div>

    <label>Ø§Ø³Ù… Ù…Ù„Ù Ø§Ù„ØµÙˆØ±Ø© ÙÙŠ Ø§Ù„Ø±ÙŠØ¨Ùˆ (example: images/myphoto.jpg)</label>
    <input id="f_imgpath" placeholder="images/yourfile.jpg">

    <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡ (Ø§ØªØ±Ùƒ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ù„ÙˆÙ‚Øª Ø§Ù„Ø¢Ù†)</label>
    <input id="f_date" placeholder="2025-11-14T10:00:00Z">

    <div class="actions">
      <button id="addBtn">Ø£Ø¶Ù Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©</button>
      <button id="downloadBtn" style="background:#2a9d8f">ØªÙ†Ø²ÙŠÙ„ ads.json</button>
      <button id="copyBtn" style="background:#666">Ù†Ø³Ø® JSON Ù„Ù„Ø­Ø§ÙØ¸Ø©</button>
    </div>
  </div>

  <h3 style="margin-top:18px">Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª (Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§)</h3>
  <div id="list"></div>

  <h3 style="margin-top:18px">JSON Ø§Ù„Ù†Ø§ØªØ¬</h3>
  <pre id="outJson">[]</pre>

  <hr>
  <h4>Ù…Ù„Ø§Ø­Ø¸Ø© Ø­ÙˆÙ„ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ± Ø¥Ù„Ù‰ GitHub</h4>
  <ol>
    <li>Ø§Ø­ÙØ¸ ØµÙˆØ±Ùƒ ÙÙŠ Ù…Ø¬Ù„Ø¯ <code>public/images/</code> ÙÙŠ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹.</li>
    <li>Ù‚Ù… Ø¨Ø¹Ù…Ù„ commit Ùˆ push Ù„Ù…Ù„ÙØ§Øª Ø§Ù„ØµÙˆØ±Ø© Ù…Ø¹ ØªØ­Ø¯ÙŠØ« <code>ads.json</code>.</li>
    <li>Ø¹Ù†Ø¯ Ø§Ø³ØªØ®Ø¯Ø§Ù… GitHub PagesØŒ Ø³ØªØµØ¨Ø­ Ø§Ù„ØµÙˆØ±Ø© Ù…ØªØ§Ø­Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ø¨Ø± <code>images/yourfile.jpg</code>.</li>
  </ol>
  <p class="small">ÙŠÙ…ÙƒÙ†Ùƒ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ± Ø¹Ø¨Ø± GitHub web: Ø§ÙØªØ­ Ø§Ù„Ù…Ø¬Ù„Ø¯ <code>public/images/</code> Ø«Ù… Ø§Ø¶ØºØ· "Upload files".</p>
</div>

<script>
const listEl = document.getElementById('list');
const outJson = document.getElementById('outJson');
let ads = [];

// load existing ads.json if present (attempt fetch)
(async function(){
  try{
    const r = await fetch('ads.json', {cache:'no-cache'});
    if(r.ok){ ads = await r.json(); renderList(); updateOutput(); }
  }catch(e){}
})();

document.getElementById('f_file').addEventListener('change', (ev)=>{
  const f = ev.target.files[0];
  const p = document.getElementById('imgPreview');
  p.innerHTML = '';
  if(!f) return;
  const img = document.createElement('img'); img.className='preview';
  img.src = URL.createObjectURL(f);
  p.appendChild(img);
  // suggest filename
  document.getElementById('f_imgpath').value = 'images/' + (f.name.replace(/\s+/g,'_'));
});

document.getElementById('addBtn').onclick = ()=>{
  const obj = {
    code: document.getElementById('f_code').value.trim() || generateCode(),
    title: document.getElementById('f_title').value.trim(),
    desc: document.getElementById('f_desc').value.trim(),
    loc: document.getElementById('f_loc').value.trim(),
    contact: document.getElementById('f_contact').value.trim(),
    img: document.getElementById('f_imgpath').value.trim(),
    created_at: document.getElementById('f_date').value.trim() || (new Date()).toISOString()
  };
  if(!obj.title && !obj.desc) return alert('Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø£Ùˆ ÙˆØµÙ');
  ads.unshift(obj); // newest first
  renderList(); updateOutput();
  // clear form
  document.getElementById('f_code').value=''; document.getElementById('f_title').value=''; document.getElementById('f_desc').value='';
  document.getElementById('f_loc').value=''; document.getElementById('f_contact').value=''; document.getElementById('f_imgpath').value='';
  document.getElementById('f_file').value=''; document.getElementById('imgPreview').innerHTML='';
};

document.getElementById('downloadBtn').onclick = ()=>{
  const blob = new Blob([JSON.stringify(ads, null, 2)], {type: 'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'ads.json'; document.body.appendChild(a); a.click(); a.remove();
  URL.revokeObjectURL(url);
};

document.getElementById('copyBtn').onclick = async ()=>{
  try{
    await navigator.clipboard.writeText(JSON.stringify(ads, null, 2));
    alert('JSON copied to clipboard');
  }catch(e){ alert('ÙØ´Ù„ Ø§Ù„Ù†Ø³Ø®'); }
};

function renderList(){
  listEl.innerHTML = '';
  ads.forEach((a, idx)=>{
    const d = document.createElement('div'); d.className='ad-item';
    d.innerHTML = `
      <div><strong>${escape(a.title||a.code)}</strong> <span class="small">#${escape(a.code)}</span></div>
      <div class="small">${escape(a.desc||'')}</div>
      <div class="small">ğŸ“ ${escape(a.loc||'')} â€¢ ${escape(a.contact||'')}</div>
      <div class="small">img: ${escape(a.img||'')}</div>
      <div style="margin-top:6px">
        <button data-idx="${idx}" class="edit">ØªØ¹Ø¯ÙŠÙ„</button>
        <button data-idx="${idx}" class="del" style="background:#d33">Ø­Ø°Ù</button>
      </div>
    `;
    listEl.appendChild(d);
  });
  // wire edit/del
  document.querySelectorAll('.del').forEach(btn=> btn.onclick = (e)=> { ads.splice(Number(e.target.dataset.idx),1); renderList(); updateOutput(); });
  document.querySelectorAll('.edit').forEach(btn=> btn.onclick = (e)=> {
    const i = Number(e.target.dataset.idx); const a = ads[i];
    document.getElementById('f_code').value = a.code || '';
    document.getElementById('f_title').value = a.title || '';
    document.getElementById('f_desc').value = a.desc || '';
    document.getElementById('f_loc').value = a.loc || '';
    document.getElementById('f_contact').value = a.contact || '';
    document.getElementById('f_imgpath').value = a.img || '';
    document.getElementById('f_date').value = a.created_at || '';
    ads.splice(i,1); renderList(); updateOutput();
  });
}

function updateOutput(){ outJson.textContent = JSON.stringify(ads, null, 2); }

function escape(s){ return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
function generateCode(){ return Math.random().toString(36).slice(2,8).toUpperCase(); }
</script>
</body>
</html>
